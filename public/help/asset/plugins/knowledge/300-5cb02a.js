"use strict";(self.webpackChunkTopWritePlugins_knowledge=self.webpackChunkTopWritePlugins_knowledge||[]).push([[300],{300:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var r=s(99),a=s(196),i=s(468);function o(e){let{children:t}=e;const{intercept:s,fetch:o}=(0,r.useActions)("page"),{setHandler:n}=(0,r.useActions)("search"),{summary:c}=(0,r.useBook)(),l=(0,r.useInPreview)(),u=(0,i.zP)(),h=(0,r.useFile)();(0,a.useMemo)((()=>{s((e=>{let{request:t}=e;t.use(u.interceptRequest())}))}),[]),(0,a.useEffect)((()=>{!l&&h&&n((async e=>{try{const{data:t}=await r.request.post(h.relative("search"),{keyword:e,ids:u.ids});return t.map((e=>(u.ids.includes(e.book)&&(e.path=u.resolvePath(e.book,e.path)),{title:e.title,path:e.path})))}catch{return[]}}))}),[h]);const p=(0,a.useMemo)((()=>c.getArticle((e=>e.getPath()===h.path))||"index.html"===h.path),[h]);return(0,a.useEffect)((()=>{if(p)void 0===h.content&&o(r.history.location.pathname);else{const e=u.resolveBook(h.path);if(e){const t=c.getArticle((()=>!0),(t=>t.getMetadata("reference")===e));if(t)return void r.history.replace(h.relative(t.path))}r.history.replace(h.relative("/"))}}),[]),p?t:null}}}]);
//# sourceMappingURL=300-5cb02a.js.map